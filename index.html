<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go2Kotlin</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />

    <style>
        :root {
            --bg-app: #f0f2f5;
            --window-bg: #ffffff;
            --border-color: #e1e4e8;
            
            /* --- CORES DO TEMA (Baseado no seu print "Min Light/GitHub") --- */
            --k-keyword: #d73a49;   /* Vermelho (func, var, return) */
            --k-func: #6f42c1;      /* Roxo (main, Println) */
            --k-string: #22863a;    /* Verde ("Texto") */
            --k-number: #005cc5;    /* Azul (10, 5) */
            --k-type: #d73a49;      /* Vermelho (int, string) */
            --k-operator: #d73a49;  /* Vermelho (*, :=) */
            --k-comment: #6a737d;   /* Cinza */
            --k-text: #24292e;      /* Preto Suave */
            
            /* Cor do Botão que você gostou */
            --btn-green: #28a745;
        }

        body {
            background-color: var(--bg-app);
            font-family: 'JetBrains Mono', monospace;
            margin: 0;
            padding: 20px;
            height: 100vh;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: 
                linear-gradient(90deg, #e1e4e8 1px, transparent 1px),
                linear-gradient(#e1e4e8 1px, transparent 1px);
            background-size: 40px 40px;
            overflow: hidden; /* Impede scroll na página inteira */
        }

        .window-frame {
            width: 95%;
            max-width: 1400px;
            height: 90vh; /* Altura fixa para forçar scroll interno */
            background-color: var(--window-bg);
            border-radius: 8px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #d1d5db;
        }

        /* --- HEADER --- */
        .title-bar {
            background: #ffffff;
            padding: 15px 20px;
            border-bottom: 2px solid #6f42c1; /* Detalhe Roxo sutil */
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .traffic-lights { display: flex; gap: 8px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .dot.red { background: #ff5f56; }
        .dot.yellow { background: #ffbd2e; }
        .dot.green { background: #27c93f; }

        .app-title { font-weight: 800; color: #24292e; letter-spacing: -0.5px; }

        /* --- TOOLBAR --- */
        .toolbar {
            padding: 10px 20px;
            background: #fafafa;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .prompt { font-size: 0.95rem; }
        .prompt span.user { color: var(--k-keyword); font-weight: bold; }
        .prompt span.host { color: var(--k-number); font-weight: bold; }
        .prompt span.path { color: var(--k-comment); }

        /* --- O BOTÃO QUE VOCÊ GOSTOU (Estilo Retro/3D) --- */
        .btn-run {
            background: #fff;
            border: 2px solid var(--btn-green);
            color: var(--btn-green);
            padding: 6px 20px;
            font-family: inherit;
            font-weight: 800;
            cursor: pointer;
            border-radius: 6px;
            box-shadow: 3px 3px 0 var(--btn-green); /* Sombra sólida */
            transition: transform 0.1s, box-shadow 0.1s;
            text-transform: uppercase;
        }
        .btn-run:hover {
            background-color: var(--btn-green);
            color: white;
        }
        .btn-run:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 var(--btn-green);
        }

        /* --- WORKSPACE (CORREÇÃO DO SCROLL) --- */
        .workspace { 
            flex: 1; 
            display: flex; 
            position: relative; 
            min-height: 0; /* O SEGREDO DO SCROLL */
        }

        .pane { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            border-right: 1px solid var(--border-color); 
            position: relative; 
            min-height: 0; /* O SEGREDO DO SCROLL */
        }
        
        .lang-badge {
            position: absolute; top: 15px; right: 20px;
            padding: 4px 10px; font-size: 0.75rem; font-weight: 700;
            border-radius: 4px; z-index: 10; pointer-events: none;
            text-transform: uppercase;
            border: 1px solid;
        }
        .badge-go { background: #e0f2fe; color: var(--k-number); border-color: #bae6fd; }
        .badge-kt { background: #f3e8ff; color: var(--k-func); border-color: #e9d5ff; }

        /* --- UNIFICAÇÃO DAS FONTES --- */
        /* Aplica a todas as classes de editor (div, pre, code) */
        .editor, pre.editor, code[class*="language-"], pre[class*="language-"] {
            font-family: var(--font-main) !important;
            font-size: var(--font-size-editor) !important;
            line-height: var(--line-height-editor) !important;
        }

        /* Editor com Scroll Interno */
        .editor {
            flex: 1;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            padding: 40px 20px 20px 20px;
            outline: none;
            overflow: auto; /* Scrollbar aparece aqui dentro */
            color: var(--k-text);
            white-space: pre;
        }

        /* --- HIGHLIGHTING (Cores do Min Light) --- */
        .token.keyword { color: var(--k-keyword) !important; font-weight: 700; }
        .token.function, .token.package { color: var(--k-func) !important; font-weight: 700; }
        .token.builtin, .token.class-name { color: var(--k-type) !important; }
        .token.string { color: var(--k-string) !important; }
        .token.number, .token.boolean { color: var(--k-number) !important; }
        .token.operator { color: var(--k-operator) !important; background: none !important; }
        .token.comment { color: var(--k-comment) !important; }
        .token.punctuation { color: var(--k-text) !important; }

        /* Status Bar */
        .status-bar {
            background: #fafafa; border-top: 1px solid var(--border-color);
            padding: 8px 20px; font-size: 0.8rem; color: #666;
            display: flex; gap: 15px; flex-shrink: 0;
        }
    </style>
</head>
<body>

    <div class="window-frame">
        <div class="title-bar">
            <div class="traffic-lights">
                <div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div>
            </div>
            <div class="app-title">GO-2-KOTLIN <span style="font-weight:400; color:#999;">v1.0</span></div>
            <div style="width: 50px;"></div>
        </div>

        <div class="toolbar">
            <div class="prompt">
                <span class="user">gopher</span>@<span class="host">go2kotlin</span>:<span class="path">~/transpiler</span>$
            </div>
            <button class="btn-run" onclick="runTranspiler()">BUILD & RUN</button>
        </div>

        <div class="workspace">
            <div class="pane">
                <div class="lang-badge badge-go">GO</div>
                <div id="editor-go" class="editor language-go">package main

import "fmt"

func main() {
	// Teste de variáveis e tipos primitivos
	var idade int = 30
	var nome string = "Go Transpiler"
	ativo := true

	if ativo {
		fmt.Println(nome)
		fmt.Println(idade)
	}
}</div>
            </div>

            <div class="pane" style="background:#fbfbfb;">
                <div class="lang-badge badge-kt">KOTLIN</div>
                <pre id="editor-kt" class="editor language-kotlin" style="margin:0; background:transparent;"></pre>
            </div>
        </div>

        <div class="status-bar">
            <div>STATUS: <span id="status-text" style="color:var(--btn-green); font-weight:bold;">READY</span></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-kotlin.min.js"></script>
    
    <script type="module">
        import { CodeJar } from 'https://medv.io/codejar/codejar.js';

        const editorElement = document.querySelector('#editor-go');
        
        const highlight = editor => {
            editor.textContent = editor.textContent;
            Prism.highlightElement(editor);
        };

        const jar = CodeJar(editorElement, highlight);
        Prism.highlightElement(editorElement); 

        window.runTranspiler = async function() {
            const goCode = jar.toString();
            const outputEl = document.getElementById('editor-kt');
            const statusText = document.getElementById('status-text');

            statusText.innerText = "BUILDING...";
            statusText.style.color = "#e6a700";
            
            try {
                const response = await fetch('/transpile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ code: goCode })
                });
                const data = await response.json();

                if (data.error) {
                    outputEl.textContent = "// ERRO:\n" + data.error;
                    statusText.innerText = "FAILED";
                    statusText.style.color = "#d73a49";
                } else {
                    outputEl.textContent = data.kotlin;
                    statusText.innerText = "SUCCESS";
                    statusText.style.color = "#28a745";
                }
                Prism.highlightElement(outputEl);

            } catch (err) {
                statusText.innerText = "CONNECTION ERROR";
                statusText.style.color = "#d73a49";
            }
        };
    </script>
</body>
</html>